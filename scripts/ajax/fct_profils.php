<?php/*   _|_|_|  _|_|_|    _| _|        _|    _|  _|        CBO FrameWork _|        _|_|_|    _|        (c) 2018 Cédric Bouillon _|        _|    _|  _|   _|_|_|  _|_|_|    _|_|_|_|--------------------------------------------------------Contrôleur Ajax PROFILS------------------------------------------------------*/// Initialisation du mode d'appel$mode       = isset($_REQUEST['mode']) ? $_REQUEST['mode'] : '';// Intégration de la configuration du FrameWork et des autorisationsrequire_once '../php/config.php';// Instanciation du Manager$profilsManager = new ProfilManager($cnx);$fonctionNom = 'mode'.ucfirst($mode);if (function_exists($fonctionNom)) {	$fonctionNom();}/** * La développeuse compile le C... *//* ------------------------------------MODE - Switch les droits d'un profil------------------------------------*/function modeSwitchDroit() {	global		$profilsManager;	$droit 		= isset($_REQUEST['droit']) 	? trim(strtolower($_REQUEST['droit'])) 	: '';	$valeur 	= isset($_REQUEST['valeur']) 	? intval($_REQUEST['valeur']) 			: -1;	$id_profil 	= isset($_REQUEST['id_profil']) ? intval($_REQUEST['id_profil']) 		: -1;	if ($id_profil < 0 || $valeur < 0 || $droit == '') { exit; }	$profil = $profilsManager->getProfil($id_profil);	if (!$profil instanceof Profil) { exit; }	$methode = 'set' . ucfirst($droit);	if (!method_exists($profil,$methode)) {	exit; }	$profil->$methode($valeur);	// Mise à jour du niveau	$niveau = 1;	if ((int)$profil->getIs_resp()  == 1) { $niveau = $niveau + 1; }	if ((int)$profil->getIs_admin() == 1) { $niveau = $niveau + 2; }	if ((int)$profil->getIs_dev()   == 1) { $niveau = $niveau + 3; }	$profil->setNiveau($niveau);	echo $profilsManager->saveProfil($profil) ? $niveau : '0';	exit;} // FIN mode