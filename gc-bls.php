<?php/**------------------------------------------------------------------------PAGE - ADMIN - Gescom - BLsCopyright (C) 2020 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2020 Intersed@version   1.0@since     2020------------------------------------------------------------------------ */require_once 'scripts/php/config.php';require_once 'scripts/php/check_admin.php';$h1     = 'Bons de livraison';$h1fa   = 'fa-fw fa-file-invoice';$id = isset($_REQUEST['i']) ? intval(base64_decode($_REQUEST['i'])) : 0;$bl = false;if ($id > 0) {	$blsManager = new BlManager($cnx);	$bl = $blsManager->getBl($id, false);	if ($bl instanceof Bl) {		$h1 = 'Bon de livraison ' . $bl->getNum_bl();	}}include('includes/header.php');?><div class="container-fluid page-admin">    <form class="row mb-3" id="filtres">        <input type="hidden" name="mode" value="getListeBls"/>        <input type="hidden" name="page" value="1"/>        <input type="hidden" name="id" value="<?php echo $id; ?>"/>        <div class="col-10">            <div class="row">                <div class="col-3">                    <div class="input-group">                        <div class="input-group-prepend">                            <span class="input-group-text">Du</span>                        </div>                        <input type="text" class="form-control datepicker border-right-0" placeholder="Date" name="date_du" value="<?php						$dt = new DateTime(date('Y-m-d'));						$dt->modify('-1 month');                        if ($dt->format('Y-m-d') < '2021-11-01') {							$dt = new DateTime(date('2021-11-01'));                        }						echo $id > 0 ? '' :  $dt->format('d/m/Y');						?>">                        <div class="input-group-prepend">                            <span class="input-group-text">au</span>                        </div>                        <input type="text" class="form-control datepicker" placeholder="Date" name="date_au" value="">                    </div>                </div>                <div class="col-1">                    <input type="text" class="form-control" placeholder="Numéro" name="numbl" value="<?php echo $bl instanceof Bl ? $bl->getNum_bl() : ''; ?>">                </div>                <div class="col-1">                    <input type="text" class="form-control" placeholder="Commande" name="numcmd" value="">                </div>                <div class="col">                    <div class="input-group">                        <div class="input-group-prepend">                            <span class="input-group-text"><i class="fa fa-address-card gris-9"></i></span>                        </div>                        <select class="selectpicker form-control show-tick" name="id_client[]" title="Client" data-live-search="true"  multiple   data-selected-text-format = "count > 1" data-live-search-placeholder="Rechercher">                            <option value="0">Tous</option>                            <option data-divider="true"></option>							<?php							$tiersManager = new TiersManager($cnx);							$listeClients = $tiersManager->getListeClients([]);							if (is_array($listeClients)) {								foreach ($listeClients as $clt) { ?>                                    <option value="<?php echo $clt->getId(); ?>"><?php echo $clt->getNom(); ?></option>								<?php }							}							?>                        </select>                    </div>                </div>                <div class="col-1">                        <select class="selectpicker form-control show-tick" name="chiffre">                            <option value="-1" selected title="Chiffrage">Tous</option>                            <option data-divider="true"></option>                            <option value="1">Chiffrés</option>                            <option value="0" title="Non chif.">Non chiffrés</option>                        </select>                </div>                <div class="col-1">                        <select class="selectpicker form-control show-tick" name="facture" >                            <option value="-1" selected title="Facturation">Tous</option>                            <option data-divider="true"></option>                            <option value="1">Facturés</option>                            <option value="0" title="Non fact.">Non facturés</option>                        </select>                </div>                <div class="col-2">                        <select class="selectpicker form-control show-tick" name="statut">                            <option value="-1" selected title="Statut">Tous</option>                            <option data-divider="true"></option>                            <option value="0">Supprimés</option>                            <option value="1">En attente</option>                            <option value="2">Générés</option>                        </select>                </div>            </div>        </div>        <div class="col-2 boutons-droite text-right">            <div class="row">                <div class="col-8">                    <button type="button" class="btn btn-info form-control btnRecherche"><i class="fa fa-search mr-1 fa-fw"></i> Rechercher&hellip;</button>                </div>                <div class="col-4">                    <a href="gc-bls.php" class="btn btn-secondary form-control"><i class="fa fa-backspace mr-1 fa-fw"></i></a>                </div>            </div>        </div>    </form>    <div class="row">        <div class="col-12 col-xl-10" id="listeBls"><i class="fa fa-spin fa-spinner fa-2x"></i></div>        <div class="col-12 col-xl-2 text-right boutons-droite">            <div class="alert alert-secondary">                <a href="gc-bl-creation.php" class="btn btn-info form-control text-left pl-3 btnCreerBl"><i class="fa fa-plus-circle fa-fw fa-lg mr-2"></i>Nouveau BL&hellip;</a>                <button type="button" class="btn btn-dark form-control text-left pl-3 btnCreerFacture mt-2"><i class="fa fa-file-invoice-dollar fa-fw fa-lg mr-2"></i>Créer une facture&hellip;</button>                <button type="button" class="btn btn-dark form-control text-left pl-3 btnCreerPackingList mt-2"><i class="fa fa-file-alt fa-fw fa-lg mr-2"></i>Créer une Packing List&hellip;</button>                 <a href="gc-all.php" class="btn btn-secondary form-control text-left pl-3 mt-2"><i class="fa fa-file-invoice fa-fw fa-lg mr-2"></i>Tous les documents&hellip;</a>            </div>        </div>    </div></div><?phpinclude('includes/modales/modal_envoi_mail.php');include('includes/footer.php');