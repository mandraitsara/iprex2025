<?php/**------------------------------------------------------------------------PAGE - DEV - Suppression des utilisateursCopyright (C) 2019 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2019 Intersed@version   1.0@since     2018------------------------------------------------------------------------ */require_once 'scripts/php/config.php';// Vérifie une authentification par login/mdp adminrequire_once 'scripts/php/check_admin.php';// On restreint la page aux Administrateurs Devéloppeursif (!$utilisateur->isDev()) {  header('Location: index.php'); }$usersManager   = new UserManager($cnx);$profilsManager = new ProfilManager($cnx);$h1     = 'Utilisateurs supprimés';$h1fa   = 'fa-fw fa-trash-alt';include('includes/header.php');// Récup des logs$params = ['show_devs' => true, 'show_supprimes' => true, 'dev_supprimes' => true];$listeUsers = $usersManager->getListeUsers($params);?><div class="container-fluid">    <div class="row" id="listeDocs">        <div class="col">            <?php            // Pas de users            if (empty($listeUsers)) { ?>                <div class="alert alert-info">                    <i class="fa fa-info-circle fa-lg mr-1"></i> Aucun utilisateur supprimé.                </div>            <?php            // Des users supprimés ont été trouvés            } else { ?>                <div class="row">                    <div class="col-10">                        <table class="admin w-100">                            <thead>                            <tr>                                <th class="text-center">ID</th>                                <th>Nom</th>                                <th>Profil (débrayé)</th>                                <th>E-mail (préfixé)</th>                                <th>Supprimé le</th>                            </tr>                            </thead>                            <tbody>                            <?php                            foreach ($listeUsers as $user) {                                // Le profil d'un user supprimé a son ID multiplié par 10.                                // On Divise pour récupérer le profil de base                                // (Ceci afin de pouvoir supprimer un profil plus utilisé)                                $profil = $profilsManager->getProfil($user->getProfil_id() / 10);                                // L'email d'un user supprimé est préfixé par un datetime pour le rendre ré-utilisable                                ?>                                <tr>                                    <td class="w-minimax-admin-cell text-center"><span class="badge badge-pill badge-warning badge-id"><?php echo $user->getId();?></span></td>                                    <td class="text-20"><?php echo $user->getNomComplet(); ?></td>                                    <td><?php echo $profil instanceof Profil ? $profil->getNom() : '<i class="fa fa-question-circle text-danger"></i> Profil ID '.$user->getProfil_id() /10 .' introuvable'; ?></td>                                    <td><?php echo $user->getEmail(); ?></td>                                    <td><?php echo ucfirst(Outils::getDate_verbose($user->getDate_modif())); ?></td>                                </tr>                            <?php } ?>                            </tbody>                        </table>                    </div>                    <div class="col-2">                        <div class="alert alert-danger">                            Afin de garantir la traçabilité et le référentiel ITIL, les utilisateurs ne peuvent être supprimés définitivement.                        </div>                    </div>                </div>			<?php            } // FIN test users supprimés ?>        </div>    </div></div><?phpinclude('includes/footer.php');