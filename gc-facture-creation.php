<?php/**------------------------------------------------------------------------PAGE - ADMIN - Gescom - Facture - CréationCopyright (C) 2020 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2020 Intersed@version   1.0@since     2020------------------------------------------------------------------------ */require_once 'scripts/php/config.php';require_once 'scripts/php/check_admin.php';$h1     = 'Nouvelle facture sans BL';$h1.= '<a href="gc-factures.php" class="float-right btn btn-secondary btn-sm margin-right-5"><i class="fa fa-undo-alt gris-c mr-1"></i> Retour à la liste</a>';$h1fa   = 'fa-fw fa-file-invoice-dollar';include('includes/header.php');$blmanager      = new BlManager($cnx);$tiersManager   = new TiersManager($cnx);$languesManager = new LanguesManager($cnx);$listeClients   = $tiersManager->getListeClients();$transporteurs  = $tiersManager->getListeTransporteurs();$langues = $languesManager->getListeLangues(['actif' => 1]);$ids_langues = [];foreach ($langues as $l) { $ids_langues[] = $l->getId(); }?><div class="container-fluid">    <div class="row">        <div class="col-9">            <table class="table table-blfact table-v-middle">                <thead>                <tr>                    <th class="w-100px">Code</th>                    <th>Produit</th>                    <th class="w-150px">Origine</th>                    <th class="w-150px">N° de lot</th>                    <th class="text-center w-75px">Colis</th>                    <th class="text-center w-75px">Qté</th>                    <th class="text-right padding-right-10 w-150px">Poids (Kg)</th>                    <th class="text-right padding-right-10 bl-chiffre w-100px">PU HT (€)</th>                    <th class="text-right padding-right-10 bl-chiffre w-150px">Total HT (€)</th>                    <th class="text-right padding-right-10 bl-chiffre w-100px <?php                    echo !$utilisateur->isDev() && !$utilisateur->isAdmin() ? 'd-none' : ''; ?>">Prix achat (€)</th>                    <th class="t-actions text-center w-50px">Action</th>                </tr>                </thead>                <thead class="formulaire-table">                <tr>                    <td colspan="2">                        <select class="form-control selectpicker" name="id_pdt" title="Sélectionnez un produit à ajouter..."                                data-size="10"                                data-live-search="true" data-live-search-placeholder="Rechercher">                            <?php                            $produitsManager = new ProduitManager($cnx);                            foreach ($produitsManager->getListeProduits(['show_inactifs' => true]) as $pdt) { ?>                                <option value="<?php echo $pdt->getId(); ?>" data-subtext="<?php echo $pdt->getCode(); ?>"><?php echo $pdt->getNom(); ?></option>                            <?php }                            ?>                        </select>                    </td>                    <td>                        <select class="form-control selectpicker" name="id_pays" title="Facultatif" data-size="8">                            <?php                            $paysManager = new PaysManager($cnx);                            foreach ($paysManager->getListePays() as $pays) { ?>                                <option value="<?php echo $pays->getId(); ?>"><?php echo $pays->getNom(); ?></option>                            <?php }                            ?>                        </select>                    </td>                    <td><input type="text" class="form-control" name="numlot" placeholder="Facultatif" value=""/></td>                    <td><input type="text" class="form-control text-center" name="nb_colis" placeholder="0" value=""/></td>                    <td><input type="text" class="form-control text-center" name="qte" placeholder="1" value=""/></td>                    <td><input type="text" class="form-control text-right" name="poids" placeholder="0.000" value=""/></td>                    <td><input type="text" class="form-control text-right" name="pu_ht" placeholder="0.00" value=""/></td>                    <td class="text-right padding-top-10 gris-9">&mdash;</td>                    <td <?php                    echo !$utilisateur->isDev() && !$utilisateur->isAdmin() ? 'class="d-none"' : ''; ?>><input type="text" class="form-control text-right" name="pa_ha" placeholder="0.00" value=""/></td>                    <td class="t-actions"><button type="button" class="btn btn-success btn-sm btnAjouterProduit"><i class="fa fa-check mr-1"></i>Ajouter</button></td>                </tr>                </thead>                <tbody id="listeProduitsFacture">                </tbody>            </table>        </div>        <div class="col-3">            <form class="alert alert-secondary" id="formFacture">                <input type="hidden" name="mode" value="saveFacture" />                <div id="produits"></div>                <div class="row mb-1">                    <div class="col-4 padding-top-10">                        <span class="gris-7">N° commande</span>                    </div>                    <div class="col-8">                        <input type="text" class="form-control" placeholder="Numéro de commande" name="num_cmd" maxlength="32" id="num_cmd" value=""/>                    </div>                </div>                <div class="row mb-1">                    <div class="col-4 padding-top-10">                        <span class="gris-7">Date</span>                    </div>                    <div class="col-8">                        <div class="input-group">                            <input type="text" class="datepicker form-control" placeholder="Cliquez ici" name="date" value="<?php echo date('d/m/Y'); ?>"/>                            <div class="input-group-append">                                <span class="input-group-text"><i class="far fa-calendar-alt gris-5 fa-lg"></i></span>                            </div>                        </div>                    </div>                </div>                <div class="row mb-1">                    <div class="col-4 padding-top-10">                        <span class="gris-7">Client facturé</span>                    </div>                    <div class="col-8">                        <select class="selectpicker form-control show-tick" data-live-search="true" data-live-search-placeholder="Rechercher" name="id_t_fact" title="Sélectionnez...">                            <?php                            foreach ($listeClients as $clt) { ?>                                <option value="<?php echo $clt->getId(); ?>"><?php echo $clt->getNom(); ?></option>                            <?php }                            ?>                        </select>                    </div>                </div>                <div class="row mb-1">                    <div class="col-4 padding-top-10">                        <span class="gris-7">Client livré</span>                    </div>                    <div class="col-8">                        <select class="selectpicker form-control show-tick" data-live-search="true" data-live-search-placeholder="Rechercher" name="id_t_livr" id="id_tiers_livraison" title="Sélectionnez (si différent)...">                            <?php                            foreach ($listeClients as $clt) { ?>                                <option value="<?php echo $clt->getId(); ?>" ><?php echo $clt->getNom(); ?></option>                            <?php }                            ?>                        </select>                    </div>                </div>                <div class="row mb-1">                    <div class="col-4 padding-top-10">                        <span class="gris-7">Adresse</span>                    </div>                    <div class="col-8">                        <select class="selectpicker form-control show-tick" data-live-search="true" data-live-search-placeholder="Rechercher" name="id_adresse" id="selectAdresses">                        </select>                    </div>                </div>                <div class="row mb-1">                    <div class="col-4 padding-top-10">                        <span class="gris-7">Transporteur</span>                    </div>                    <div class="col-8">                        <select class="selectpicker form-control show-tick" name="id_transp" <?php                        echo count($transporteurs) > 1 ? 'title="Sélectionnez..."' : '' ?>>                            <?php                            foreach ($tiersManager->getListeTransporteurs() as $trans) { ?>                                <option value="<?php echo $trans->getId(); ?>"><?php echo $trans->getNom(); ?></option>                            <?php }                            ?>                        </select>                    </div>                </div>                <div class="row mt-2">                    <div class="col-8 texte-fin text-12 pt-2 text-info">                        <i class="fa fa-info-circle mr-1"></i> Utilisez les frais additionnels pour intégrer les frais de port (transport).                    </div>                    <div class="col-4">                        <button type="button" class="btn btn-success form-control text-center" id="btnEnregistreFacture">                            <i class="fa fa-fw fa-save mb-1"></i><br>Enregistrer                        </button>                    </div>                </div>            </form>        </div>    </div></div><?phpinclude('includes/footer.php');