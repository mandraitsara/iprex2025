<?php/**------------------------------------------------------------------------PAGE - DEV - ZonesCopyright (C) 2020 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2020 Intersed@version   1.0@since     2018------------------------------------------------------------------------ */require_once 'scripts/php/config.php';// Vérifie une authentification par login/mdp adminrequire_once 'scripts/php/check_admin.php';// On restreint la page aux Administrateurs Devéloppeursif (!$utilisateur->isDev()) {  header('Location: index.php'); }$h1     = 'Zones de traductions Gescom';$h1fa   = 'fa-fw fa-columns';include('includes/header.php');$zonesManager = new ZonesManager($cnx);// Si on ajoute une nouvelle zoneif (isset($_POST['addZone'])) {   $code = isset($_POST['code']) ?  Outils::removeAccents(trim(strtolower(str_replace(' ','_', $_POST['code'])))) : '';   if ($code  != '') {       $actif = isset($_POST['actif']) ? 1 : 0;       $zone = $zonesManager->getZoneByCode($code);       if(!$zone instanceof Zone) {           $zone = new Zone([]);           $zone->setActif($actif);           $zone->setCode($code);           $zone->setSupprime(0);           if (!$zonesManager->saveZone($zone)) {  ?>               <div class="row"><div class="col"><div class="alert alert-danger"><i class="fa fa-exclamation-triangle mr-1"></i>Erreur lors de l'enregistrement de la zone en BDD !</div></div></div>           <?php  }       } else { ?>           <div class="row"><div class="col"><div class="alert alert-danger"><i class="fa fa-exclamation-triangle mr-1"></i>Une zone existe déjà avec ce code ! Elle est peut-être en statut supprimé, vérifiez en BDD...</div></div></div>       <?php }   } // FIN test code ok} // FIN ajout d'une nouvelle zone$zones = $zonesManager->getListeZones();?><div class="container-fluid">    <div class="row justify-content-center">        <div class="col-6">            <?php            // Pas de zones            if (empty($zones)) { ?>                <div class="alert alert-warning text-center padding-50">                    <i class="fa fa-info-circle fa-3x mb-3"></i>                    <p class="nomargin">Aucune zone.</p>                </div>            <?php            // Des zones ont été trouvés            } else {				?>                <table class="admin w-100 table table-v-middle">                    <thead>                    <tr>                        <th class="text-center w-50px">ID</th>                        <th>Code</th>                        <th class="w-court-admin-cell t-actions">Activation</th>                        <th class="w-mini-admin-cell t-actions">Supprimer</th>                    </tr>                    </thead>                    <tbody>					<?php					foreach ($zones as $zone) { ?>                        <tr data-id="<?php echo $zone->getid(); ?>">                            <td class="text-center w-50px"><span class="badge badge-secondary badge-pill texte-fin"><?php echo $zone->getId(); ?></span></td>                            <td><kbd><?php echo $zone->getCode(); ?></kbd></td>                            <td>                                <input type="checkbox"                                       class="togglemaster"                                       <?php echo $zone->getActif() == 1 ? 'checked' : ''; ?>                                       data-toggle="toggle"                                       data-on="Activée"                                       data-off="Désactivée"                                       data-onstyle="success"                                       data-offstyle="secondary"                                       data-size="small"                                />                            </td>                            <td class="text-center">                                <button type="button" class="btn btn-danger btn-sm btnSupprZone"><i class="fa fa-trash-alt"></i></button>                            </td>                        </tr>					<?php } ?>                    </tbody>                </table>				<?php			} // FIN test résultats            ?>        </div>    </div>    <form class="row justify-content-center" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">        <div class="col-6">        <div class="alert alert-secondary col-12">            <div class="row padding-top-10">                <div class="col-6">                    <div class="input-group mb-3">                        <div class="input-group-prepend">                            <span class="input-group-text">Code</span>                        </div>                        <input type="text" class="form-control" placeholder="Code de la zone" name="code" />                    </div>                </div>                <div class="col-2">                    <input type="checkbox"                           class="togglemaster"                           checked                           data-toggle="toggle"                           data-on="Activée"                           data-off="Désactivée"                           data-onstyle="success"                           data-offstyle="secondary"                           name="actif"                    />                </div>                <div class="col text-right">                    <button type="submit" class="btn btn-info" name="addZone">                        <i class="fa fa-check mr-1"></i> Ajouter                    </button>                </div>            </div>            </div>        </div>    </form></div><?phpinclude('includes/footer.php');