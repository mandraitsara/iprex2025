<?php/**------------------------------------------------------------------------INCLUDE PHP - Barre Debug - Mode DéveloppeurCopyright (C) 2018 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2018 Intersed@version   1.0@since     2018------------------------------------------------------------------------ */ ?><!-- DEBUG BAR --><div id="debugbar">    <a href="<?php echo __CBO_ROOT_URL__; ?>"><img src="<?php echo __CBO_ROOT_URL__; ?>img/favicon.png" class="logodebug"/></a>	CBO v.<?php echo $_SESSION['cbofv'];?>	<span class="margin-left-15 separator">|</span>    <!-- Temps -->	<?php $difference_ms =  number_format((microtime(true) - $timestamp_debut) * 1000, 0, ',',' ') ; ?>    <i class="fas fa-clock margin-left-15 margin-right-5 <?php    if ($difference_ms < 1000) {        $timeMsLevelColor = 'success color-light-2';    } else if ($difference_ms < 2000) {		$timeMsLevelColor = 'warning color-light-1';    } else {		$timeMsLevelColor = 'danger color-light-1';    }    echo 'text-'.$timeMsLevelColor;    ?>"></i>	Page générée en	<?php echo $difference_ms > 1000 ? number_format($difference_ms/1000,3,',',' ').' s' : $difference_ms . ' ms'; ?>.    <!-- Mémoire -->	<?php	$finalMem = memory_get_peak_usage();	$usageMem = $finalMem - $initialMem;	if ($usageMem/1000 < 500) {		$memLevelColor = 'success color-light-2';	} else if ($usageMem/1000 < 2000) {		$memLevelColor = 'warning color-light-1';	} else {		$memLevelColor = 'danger color-light-1';	}?>   <i class="fas fa-microchip fa-sm margin-left-15 margin-right-5 text-<?php echo $memLevelColor;?>"></i>    Peak :    <?php    echo Outils::getNiceFileSize($usageMem); ?><span class="debug-inline-drop">     <i class="fab fa-php margin-left-15 text-18 margin-top--2 margin-right-5 gris-c"></i>        <div class="debug-details">            <p>Configuration de PHP</p><hr><ul>    <li>Version : <xmp><?php echo phpversion(); ?></xmp></li>    <li>Mémoire dispinible : <xmp><?php echo ini_get('memory_limit'); ?>o</xmp></li>    <li>Longueur maximale des noms de fichiers : <xmp><?php echo PHP_MAXPATHLEN; ?></xmp></li>    <li>OS : <xmp><?php echo PHP_OS; ?></xmp></li>    <li>Interface : <xmp><?php echo strtoupper(php_sapi_name()); ?></xmp></li>    <li>Préfixe : <xmp><?php echo PHP_PREFIX; ?></xmp></li>    <li>Suffixe des bibliothèques partagées : <xmp><?php echo PHP_SHLIB_SUFFIX ; ?></xmp></li>    <li>Chemin <em>__DIR__</em> : <xmp><?php echo __DIR__    ; ?></xmp></li>    <li><a href="<?php echo __CBO_ROOT_URL__?>_phpinfo.php" target="_blank" class="btn btn-secondary btn-sm margin-top-5"><i class="fas fa-external-link-square-alt margin-top--2 margin-right-5"></i> PHP Info</a></li></ul>        </div></span>	<span class="margin-left-10 separator">|</span>    <!-- JS -->	<span class="debug-group">		<i class="fab fa-js margin-left-15 margin-right-5 gris-c"></i>		JS        <i class="fas fa-chevron-right text-8 gris-9"></i>		<span class="badge badge-secondary badge-light"><?php echo count($js); ?></span>		<?php if (isset($js_page) && $js_page !== false) { ?>+			<i class="fas fa-robot margin-left--2 margin-top--5 text-success color-light-2"></i>		<?php } ?>		<div class="debug-details">			<p><span class="badge badge-secondary badge-light"><?php echo count($js); ?></span> appels JS			<?php if (isset($js_page) && $js_page !== false) { ?> dont un autochargé <i class="fas fa-robot fa-sm gris-c margin-top--2 margin-left-2"></i><?php } ?> :            </p><hr>			<ul>				<?php                $testJsPageName = 'scripts/js/'.basename($_SERVER["SCRIPT_FILENAME"], '.php').'.js';				$js404 = false;				$testJsExist = '';				foreach ($js as $j) {				    if (preg_match('#vendor/#', $j)) {						$colorJsFlag = 'text-warning';                    } else if (preg_match('#scripts/js#', $j)) {						$colorJsFlag = 'text-info color-light-2';					} else {						$colorJsFlag = 'gris-c';                    }                    if ($j == $testJsPageName) {						$colorJsFlag = 'text-success color-light-4';                    }                    $jArrayToStyle = explode('/', $j);                    end($jArrayToStyle);                    $styledJ = '<xmp class="gris-c">';					$styledJ.= str_replace( end($jArrayToStyle), '',$j);					$styledJ.= '</xmp><xmp>';					$styledJ.= end($jArrayToStyle).'</xmp>';					if (!file_exists($j)) {						$js404 = true;						$testJsExist = ' class="asset404"';					}					?>					<li<?php echo $testJsExist; ?>><i class="<?php echo $j == $testJsPageName ? 'fas fa-robot' : 'fab fa-js-square'; echo ' '.$colorJsFlag;?> fa-fw fa-sm margin-right-5"></i><?php echo $styledJ; ?></li>				<?php } ?>			</ul>		</div>		<?php if ($js404) { ?>            <i class="fas fa-exclamation-triangle asset404"></i>		<?php } ?>	</span>    <span class="margin-left-15 separator">|</span>    <!-- CSS -->	<span class="debug-group">		<i class="fab fa-css3-alt margin-left-15 margin-right-5 gris-c"></i>		CSS        <i class="fas fa-chevron-right text-8 gris-9"></i>		<span class="badge badge-secondary badge-light"><?php echo count($css); ?></span>		<?php if (isset($css_page) && $css_page !== false) { ?>+			<i class="fas fa-robot margin-left--2 margin-top--5 text-success color-light-2"></i>		<?php } ?>		<div class="debug-details">			<p><span class="badge badge-secondary badge-light"><?php echo count($css); ?></span> appels CSS			<?php if (isset($css_page) && $css_page !== false) { ?> dont un autochargé <i class="fas fa-robot fa-sm gris-c margin-top--2 margin-left-2"></i><?php } ?> :            </p><hr>			<ul>				<?php				$testCssPageName = 'css/'.basename($_SERVER["SCRIPT_FILENAME"], '.php').'.css';				$css404 = false;				$testCssExist = '';                foreach ($css as $c) {					if (preg_match('#vendor/#', $c)) {						$colorCssFlag = 'text-warning';					} else if (preg_match('#css/#', $c)) {						$colorCssFlag = 'text-info color-light-2';					} else {						$colorCssFlag = 'gris-c';					}					if ($c == $testCssPageName) {						$colorCssFlag = 'text-success color-light-4';					}					$cArrayToStyle = explode('/', $c);					end($cArrayToStyle);					$styledC = '<xmp class="gris-c">';					$styledC.= str_replace( end($cArrayToStyle), '',$c);					$styledC.= '</xmp><xmp>';					$styledC.= end($cArrayToStyle).'</xmp>';					if (!file_exists($c)) {						$css404 = true;						$testCssExist = ' class="asset404"';                    }                    ?>					<li<?php echo $testCssExist; ?>><i class="<?php echo $c == $testCssPageName ? 'fas fa-robot' : 'fab fa-css3'; echo ' '.$colorCssFlag;?> fa-fw  fa-sm margin-right-5"></i><?php echo $styledC; ?></li>				<?php } ?>			</ul>		</div>        <?php if ($css404) { ?>            <i class="fas fa-exclamation-triangle asset404"></i>        <?php } ?>	</span>	<span class="margin-left-15 separator">|</span>    <!-- GET -->    <?php if (!empty($_GET)) { ?>    <span class="debug-group">        <i class="fas fa-link margin-left-15 margin-right-5 gris-c"></i>        GET        <i class="fas fa-chevron-right text-8 gris-9"></i>        <span class="badge badge-secondary badge-light"><?php echo count($_GET); ?></span>        <div class="debug-details">			<?php $pluriel = count($_GET) > 1 ? 's' : ''; ?>            <p><span class="badge badge-secondary badge-light"><?php echo count($_GET); ?></span> variable<?php echo $pluriel; ?> GET :            </p><hr>            <ul>				<?php foreach ($_GET as $s => $v) { ?>                    <li><i class="fas fa-link fa-sm margin-right-5 gris-c"></i><xmp><?php echo $s; ?></xmp></li>				<?php } ?>            </ul>        </div>    </span>    <?php } ?>    <!-- POST -->	<?php if (!empty($_POST)) { ?>    <span class="debug-group">        <i class="fas fa-newspaper margin-left-15 margin-right-5 gris-c"></i>        POST        <i class="fas fa-chevron-right text-8 gris-9"></i>        <span class="badge badge-secondary badge-light"><?php echo count($_POST); ?></span>        <div class="debug-details">			<?php $pluriel = count($_POST) > 1 ? 's' : ''; ?>            <p><span class="badge badge-secondary badge-light"><?php echo count($_POST); ?></span> variable<?php echo $pluriel; ?> POST :            </p><hr>            <ul>				<?php foreach ($_POST as $s => $v) { ?>                    <li><i class="fas fa-newspaper fa-sm margin-right-5 gris-c"></i><xmp><?php echo $s; ?></xmp></li>				<?php } ?>            </ul>        </div>    </span>	<?php } ?>    <!-- Sessions -->	<a class="debug-group" href="<?php echo __CBO_ROOT_URL__?>_variables.php">		<i class="fas fa-hdd margin-left-15 margin-right-5 gris-c"></i>		Session        <i class="fas fa-chevron-right text-8 gris-9"></i>		<span class="badge badge-secondary badge-light"><?php echo count($_SESSION); ?></span>		<div class="debug-details">			<?php $pluriel = count($_SESSION) > 1 ? 's' : ''; ?>			<p><span class="badge badge-secondary badge-light"><?php echo count($_SESSION); ?></span> variable<?php echo $pluriel; ?> de session :            </p><hr>			<ul>				<?php foreach ($_SESSION as $s => $v) { ?>					<li><i class="fas fa-hdd fa-sm margin-right-5 gris-c"></i><xmp><?php echo $s; ?></xmp></li>				<?php } ?>			</ul>		</div>	</a>    <!-- Cookies -->	<a class="debug-group" href="<?php echo __CBO_ROOT_URL__?>_variables.php">		<i class="fas fa-bullseye margin-left-15 margin-right-5 gris-c"></i>		Cookies        <i class="fas fa-chevron-right text-8 gris-9"></i>		<span class="badge badge-secondary badge-light"><?php echo count($_COOKIE); ?></span>		<div class="debug-details">			<?php $pluriel = count($_COOKIE) > 1 ? 's' : ''; ?>			<p><span class="badge badge-secondary badge-light"><?php echo count($_COOKIE); ?></span> cookie<?php echo $pluriel; ?> :            </p><hr>			<ul>				<?php foreach ($_COOKIE as $c => $v) { ?>					<li><i class="fas fa-bullseye fa-sm margin-right-5 gris-c"></i><xmp><?php echo $c; ?></xmp></li>				<?php } ?>			</ul>		</div>	</a>    <!-- Objets -->	<?php if (isset($_SESSION['classcalls']) && !empty($_SESSION['classcalls'])) { ?>	<span class="margin-left-15 separator">|</span>	<span class="debug-group">		<i class="fas fa-box margin-left-15 margin-right-5 gris-c"></i>		Objets        <i class="fas fa-chevron-right text-8 gris-9"></i>		<span class="badge badge-secondary badge-light"><?php echo count($_SESSION['classcalls']); ?></span>		<div class="debug-details">			<?php $pluriel = count($_SESSION['classcalls']) > 1 ? 's' : ''; ?>			<p><span class="badge badge-secondary badge-light"><?php echo count($_SESSION['classcalls']); ?></span> objet<?php echo $pluriel; ?> instancié<?php echo $pluriel; ?> :            </p><hr>			<ul>				<?php foreach ($_SESSION['classcalls'] as $classcall) {					if (preg_match('#Manager#', $classcall)) {						$colorClassFlag = 'text-warning';						$faClassCall = 'cogs';					} else if ($classcall == 'Outils') {						$colorClassFlag = 'text-success color-light-4';						$faClassCall = 'wrench';					} else {						$colorClassFlag = 'text-info color-light-2';						$faClassCall = 'box';					}				    ?>					<li><i class="fas fa-<?php echo $faClassCall;?> fa-fw fa-sm margin-right-5 <?php echo $colorClassFlag; ?>"></i><xmp><?php echo $classcall; ?></xmp></li>				<?php } ?>			</ul>		</div>	</span>	<?php } ?>    <!-- Requêtes PDO -->	<?php if (isset($_SESSION['pdoq']) && !empty($_SESSION['pdoq'])) { ?>        <span class="margin-left-15 separator">|</span>        <span class="debug-group debug-requettes pointeur">		<i class="fas fa-database margin-left-15 margin-right-5 gris-c"></i>		Requêtes	    </span>        <i class="fa fa-eraser pointeur btn-clean-debug-requettes gris-a padding-left-5"></i>	<?php } ?>    <!-- DROITE -->    <div class="float-right">        <!-- Nom du site -->        <i class="fa fa-bug margin-right-5"></i><span class="margin-right-15 text-light vmiddle gris-c">DEBUG | <?php echo $_SESSION['nom_site']; ?></span>        <!-- Générateur de classes -->        <a href="<?php echo __CBO_ROOT_URL__?>_class-generator.php" target="_blank" class="btn btn-outline-light btn-sm"><i class="fas fa-fw fa-magic"></i>            <span class="debug-infos"><i class="fas fa-fw fa-magic margin-right-5"></i>Générateur de classes</span>        </a>        <!-- Liste des variables -->        <a href="<?php echo __CBO_ROOT_URL__?>_variables.php" target="_blank" class="btn btn-outline-light btn-sm"><i class="fas fa-fw fa-terminal"></i>            <span class="debug-infos"><i class="fas fa-fw fa-terminal margin-right-5"></i>Liste des variables</span>        </a>        <!-- Etat de la configuration -->        <a href="<?php echo __CBO_ROOT_URL__?>_etat_config.php" target="_blank" class="btn btn-outline-light btn-sm"><i class="fas fa-fw fa-cogs"></i>            <span class="debug-infos"><i class="fas fa-fw fa-cogs margin-right-5"></i>Etat de la configuration</span>        </a>        <!-- ToolKit -->        <a href="<?php echo __CBO_ROOT_URL__?>_toolkit.php" target="_blank" class="btn btn-outline-light btn-sm"><i class="fas fa-fw fa-wrench"></i>            <span class="debug-infos"><i class="fas fa-fw fa-wrench margin-right-5"></i>Memento Toolkit</span>        </a>        <!-- PHP MyAdmin -->        <?php        if (strlen($conf_bdd_myadmin) > 0) { ?>            <a href="<?php echo $conf_bdd_myadmin; ?>" target="_blank" class="btn btn-outline-light btn-sm"><i class="fas fa-fw fa-database"></i>                <span class="debug-infos"><i class="fas fa-fw fa-database margin-right-5"></i>Ouvrir PhpMyAdmin</span>            </a>        <?php } ?>        <!-- Lien icones FontAwesome-->        <?php if (isset($_SESSION['fontawesomeiconesurl']) && $_SESSION['fontawesomeiconesurl'] != '') { ?>        <a href="<?php echo $_SESSION['fontawesomeiconesurl']; ?>" target="_blank" class="btn btn-outline-light btn-sm"><i class="fab fa-fw fa-font-awesome-flag"></i>            <span class="debug-infos"><i class="fab fa-fw fa-font-awesome-flag margin-right-5"></i>Icones FontAwesome</span>        </a>        <?php } ?>        <!-- Susprendre debug -->        <a href="#" class="btn btn-outline-light btn-sm btnCloseDebugBar"><i class="fas fa-fw fa-times"></i>            <span class="debug-infos"><i class="fas fa-fw fa-times margin-right-5"></i>Suspendre le mode débug pendant 1h</span>        </a>    </div></div><!-- Console du détail des requêtes PDO --><div id="detailsRequetesPdoDebug" class="d-none"><i class="fa fa-spin fa-spinner"></i></div><!-- FIN DEBUG BAR -->