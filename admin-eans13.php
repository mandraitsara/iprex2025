<?php/**------------------------------------------------------------------------PAGE - ADMIN - EANCopyright (C) 2018 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2018 Intersed@version   1.0@since     2018------------------------------------------------------------------------ */ini_set('display_errors',1);require_once 'scripts/php/config.php';require_once 'scripts/php/check_admin.php';$produitsManager    = new ProduitManager($cnx);$logsManager        = new LogManager($cnx);$h1     = 'Racines des EAN13/14';$h1fa   = 'fa-fw fa-equals';// Si soumission du formulaire$id_kill = isset($_REQUEST['k']) ? intval($_REQUEST['k']) : 0;$racine = isset($_REQUEST['racine']) ? trim(preg_replace("/[^0-9]/", '', $_REQUEST['racine'])) : '';if ($racine != '') {	if ($produitsManager->createRacine($racine)) {	    $log = new Log();	    $log->setLog_type('info');	    $log->setLog_texte('Création de la racine EAN13 "'.$racine.'" (non activee)');	    $logsManager->saveLog($log);    }}// Si supprimer une racineif ($id_kill > 0) {    $res = $produitsManager->supprRacineEan13($id_kill);	$log = new Log([]);	$logTxt = $res ? 'S' : 'Echec de la s';	$logTxt.="uppression d'une racine EAN 13 (#".$id_kill.")";	$logType = $res ? 'info' : 'danger';	$log->setLog_type($logType);	$log->setLog_texte($logTxt);	$logsManager->saveLog($log);} // FIN supprimerinclude('includes/header.php');$racines = $produitsManager->getRacinesEan13();?><div class="container-fluid page-admin">    <div class="alert alert-danger d-xl-none  d-none d-md-block">        <i class="fa fa-exclamation-circle text-28 mr-1 v-middle"></i>Connectez-vous depuis un apareil permettant un affichage plus large pour afficher les filtres et les codes&hellip;    </div>    <div class="row margin-bottom-50">        <div class="col-12 col-xl-4 offset-xl-3">            <table class="table admin table-v-middle">                <thead>                <tr>                    <th class="text-center">Racine</th>                    <th class="text-center">Utilisations</th>                    <th class="t-actions text-center">Active</th>                    <th class="t-actions text-center">Supprimer</th>                </tr>                </thead>                <tbody>                <?php                foreach ($racines as $racine) {                    $nbUtilisations = $produitsManager->getNbUtilisationsRacineEan13($racine['racine']);                    ?>                    <tr data-id="<?php echo intval($racine['id']); ?>">                        <td class="text-center text-20">                          <?php echo $racine['racine']; ?>                        </td>                        <td class="text-center"><?php echo $nbUtilisations > 0 ? $nbUtilisations : '<span class="gris-9">Aucune</span>'; ?></td>                        <td class="t-actions text-center">                            <input type="radio" class="icheck activationRacine" name="activation" <?php echo intval($racine['active']) == 1 ? 'checked' : ''; ?>>                        </td>                        <td class="t-actions text-center">                            <button type="button" class="btn btn-danger btn-sm btnSupprRacine <?php							echo $nbUtilisations > 0 ? 'disabled' : ''; ?>" <?php                            echo $nbUtilisations > 0 ? 'disabled' : ''; ?>><i class="fa fa-trash-alt fa-fw"></i></button>                        </td>                    </tr>                <?php }                ?>                </tbody>            </table>        </div>        <div class="col-12 offset-xl-3 col-xl-2 text-right boutons-droite d-none d-md-block">            <div class="alert alert-secondary">                <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">                    <div class="input-group mb-1">                        <div class="input-group-prepend">                            <span class="input-group-text"><i class="fa fa-equals"></i></span>                        </div>                        <input type="text" class="form-control" placeholder="Nouvelle racine" name="racine" maxlength="8" />                    </div>                    <button type="submit" class="btn btn-success form-control"><i class="fa fa-plus-circle mr-1"></i> Ajouter cette racine</button>                </form>                <a href="<?php echo __CBO_ROOT_URL__; ?>admin-eans.php" class="btn btn-dark form-control text-left pl-3 mt-2 mb-2"><i class="fa fa-barcode fa-fw fa-lg mr-2"></i>Liste des EAN&hellip;</a>            </div>        </div>    </div></div><?phpinclude('includes/footer.php');