<?php/**------------------------------------------------------------------------PAGE - ADMIN - Poids emballages et palettesCopyright (C) 2020 Intersedhttp://www.intersed.fr/------------------------------------------------------------------------@author    Cédric Bouillon@copyright Copyright (c) 2020 Intersed@version   1.0@since     2018------------------------------------------------------------------------ */require_once 'scripts/php/config.php';require_once 'scripts/php/check_admin.php';$h1     = 'Poids emballages & palettes';$h1fa   = 'fa-fw fa-weight';include('includes/header.php');$poidsPalettesMaanger = new PoidsPaletteManager($cnx);if (!isset($logsManager)) { $logsManager = new LogManager($cnx); }// Si ajout$poids  = isset($_REQUEST['poids']) ? floatval(str_replace(',', '.',$_REQUEST['poids'])) : 0;$type   = isset($_REQUEST['type'])  ? intval($_REQUEST['type'])     : 0;$nom    = isset($_REQUEST['nom'])   ? trim($_REQUEST['nom'])        : '';if ($poids > 0 && $nom != '') {	$log = new Log([]);    $poidsPalette = new PoidsPalette([]);    $poidsPalette->setPoids($poids);    $poidsPalette->setType($type);    $poidsPalette->setNom($nom);    $res = $poidsPalettesMaanger->savePoidsPalette($poidsPalette);	$logTxt = $res ? 'C' : 'Echec de la c';	$logTxt.='réation nouveau poids palette ID#'.(int)$res;	$logType = $res ? 'info' : 'danger';	$log->setLog_texte($logTxt);	$log->setLog_type($logType);	$logsManager->saveLog($log);} // FIN ajout$liste = $poidsPalettesMaanger->getListePoidsPalettes();?><div class="container-fluid">    <div class="row justify-content-md-center">    <div class="col-6">            <div class="alert alert-secondary">                <div class="row">                    <div class="col text-center mb-2 mt-3">                        <span class="badge badge-secondary text-20 w-100"><i class="fa fa-grip-horizontal mr-2"></i> Poids des emballages</span>                    </div>                </div>                <?php                // Boucle sur les poids                foreach ($liste as $poidsPalette) {                    // Si ce n'est pas un poids emballage on passe...                    if ($poidsPalette->getType() != 0) { continue; }                    ?>                    <div class="form-group row" data-id="<?php echo $poidsPalette->getId();?>">                        <div class="col-12 col-md-6 col-lg-7">                            <div class="input-group input-group-lg">                                <input type="text" class="form-control" placeholder="Libellé" name="nom" value="<?php								echo $poidsPalette->getNom(); ?>" />                            </div>                        </div>                        <div class="col-12 col-md-6 col-lg-3">                            <div class="input-group input-group-lg">                                <input type="text" class="form-control text-center" placeholder="0" name="poids" value="<?php								echo number_format($poidsPalette->getPoids(),3,'.', ''); ?>"/>                                <div class="input-group-append">                                    <span class="input-group-text">Kg</span>                                </div>                            </div>                        </div>                        <div class="col-12 col-md-6 col-lg-2 text-right">                            <button type="button" class="btn btn-success btnSavePoids"><i class="fa fa-save"></i></button>                            <button type="button" class="ml-2 btn btn-outline-danger btnSupprPoids"><i class="fa fa-trash"></i></button>                        </div>                    </div>                    <?php                } // FIN boucle                ?>            </div>        </div>    <div class="col-6">        <div class="alert alert-secondary">            <div class="row">                <div class="col text-center mb-2 mt-3">                    <span class="badge badge-secondary text-20 w-100"><i class="fa fa-pallet mr-2"></i> Poids des palettes</span>                </div>            </div>			<?php			// Boucle sur les poids			foreach ($liste as $poidsPalette) {				// Si ce n'est pas un poids palette on passe...				if ($poidsPalette->getType() != 1) { continue; }				?>                <div class="form-group row" data-id="<?php echo $poidsPalette->getId();?>">                    <div class="col-12 col-md-6 col-lg-7">                        <div class="input-group input-group-lg">                            <input type="text" class="form-control" placeholder="Libellé" name="nom" value="<?php							echo $poidsPalette->getNom(); ?>" />                        </div>                    </div>                    <div class="col-12 col-md-6 col-lg-3">                        <div class="input-group input-group-lg">                            <input type="text" class="form-control text-center" placeholder="0" name="poids" value="<?php							echo number_format($poidsPalette->getPoids(),3,'.', ''); ?>"/>                            <div class="input-group-append">                                <span class="input-group-text">Kg</span>                            </div>                        </div>                    </div>                    <div class="col-12 col-md-6 col-lg-2 text-right">                        <button type="button" class="btn btn-success btnSavePoids"><i class="fa fa-save"></i></button>                        <button type="button" class="ml-2 btn btn-outline-danger btnSupprPoids"><i class="fa fa-trash"></i></button>                    </div>                </div>				<?php			} // FIN boucle			?>        </div>        <form id="formPoids" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">        <div class="alert alert-secondary mt-3">            <div class="row">                <div class="col text-center mb-2 mt-3">                    <span class="badge badge-info text-20 w-100"><i class="fa fa-plus-circle mr-2"></i> Nouvel emballage/palette</span>                </div>            </div>            <div class="form-group row">                <div class="col-12 col-lg-5 padding-top-10">                    <div class="input-group">                        <div class="input-group-prepend">                            <span class="input-group-text">Nom</span>                        </div>                        <input type="text" class="form-control" placeholder="Libellé" name="nom" value=""/>                    </div>                </div>                <div class="col-12 col-lg-3 padding-top-10">                    <select class="selectpicker form-control" name="type" title="Type">                        <option value="0">Emballage/carton/caisse...</option>                        <option value="1">Palette</option>                    </select>                </div>                <div class="col-12 col-lg-3 padding-top-10">                    <div class="input-group">                        <input type="text" class="form-control text-center" placeholder="00.000" name="poids" value=""/>                        <div class="input-group-append">                            <span class="input-group-text">Kg</span>                        </div>                    </div>                </div>                <div class="col-12 col-lg-1 padding-top-10">                    <button type="submit" class="btn btn-success"><i class="fa fa-check"></i></button>                </div>            </div>        </div>        </form>    </div></div><?phpinclude('includes/footer.php');